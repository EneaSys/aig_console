<div class="page-layout simple left-sidebar">
    <!-- SIDEBAR -->
    <fuse-sidebar class="sidebar" name="ipp-lot-filter-sidebar" position="left" lockedOpen="gt-md">
        <!-- SIDEBAR CONTENT -->
        <div class="content">
            <div>
                <div class="header p-16 border-bottom" fxLayout="row" fxLayoutAlign="center start">
                    <button mat-raised-button (click)="cleanFiltersAndLoadIppLot()">Pulisci filtri</button>
                </div>
            </div>
            <div>
                <div class="header p-16 border-bottom" fxLayout="row" fxLayoutAlign="start start">
                    <span class="h5">Cerca</span>
                </div>
                <div class="content py-16" fusePerfectScrollbar>
                    <div class="nav material2">
                        <form [formGroup]="ippLotSearchForm" (ngSubmit)="ippLotSearch()" class="p-8">
                            <div fxLayout="row">
                                <mat-form-field appearance="outline" fxFlex="100">
                                    <mat-label>Cig</mat-label>
                                    <input matInput type="string" formControlName="cig">
                                </mat-form-field>
                            </div>
                            <div fxLayout="row">
                                <mat-form-field appearance="outline" fxFlex="100">
                                    <mat-label>Descrizione</mat-label>
                                    <input matInput type="string" formControlName="description">
                                </mat-form-field>
                            </div>
                            <div fxLayout="row">
                                <mat-form-field appearance="outline" fxFlex="100">
                                    <mat-label>Date</mat-label>
                                    <input matInput [matDatepicker]="picker" placeholder="Seleziona la data"
                                        formControlName="date">
                                    <mat-datepicker-toggle matSuffix [for]="picker">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="center start">
                                <div appearance="outline" fxFlex="100">
                                    Importo minimo<br>

                                    <mat-slider class="filterSliderAmount" [displayWith]="formatFilterSlider"
                                        (input)="formatFilterAmountMin($event)" tickInterval="1000" min="1"
                                        max="1000000"></mat-slider>
                                </div>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="end start">
                                <span *ngIf="ippLotFilters.amountMin">{{ ippLotFilters.amountMin | currency:'EUR' }}</span>
                                <span *ngIf="!ippLotFilters.amountMin">non definito</span>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="center start">
                                <div appearance="outline" fxFlex="100">
                                    Importo massimo<br>
                                    <mat-slider class="filterSliderAmount" #matsliderAmountMax thumbLabel
                                        [displayWith]="formatFilterSlider" (input)="formatFilterAmountMax($event)"
                                        tickInterval="100" min="1000" max="1000001"></mat-slider>
                                </div>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="end start">
                                <span *ngIf="ippLotFilters.amountMax">{{ ippLotFilters.amountMax | currency:'EUR' }}</span>
                                <span *ngIf="!ippLotFilters.amountMax">illimitato</span>
                            </div>
                            <div fxLayout="row" class="mt-24" fxLayoutAlign="end top">
                                <button type="submit" mat-raised-button color="accent">Cerca</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div>
                <div class="header p-16 border-bottom" fxLayout="row" fxLayoutAlign="start start">
                    <span class="h5">Tipo IPP Lot</span>
                </div>
                <div class="content py-16" fusePerfectScrollbar>
                    <div class="nav material2">
                        <div class="nav-item" aria-label="inbox">
                            <a class="nav-link" matRipple (click)="setFilterIppLot('ippLotTypeCode', null)"
                                [ngClass]="{'accent': ippLotFilters.ippLotTypeCode == null}">
                                <span class="title">Tutto</span>
                            </a>
                            <a class="nav-link" matRipple (click)="setFilterIppLot('ippLotTypeCode', 'FORNITURE')"
                                [ngClass]="{'accent': ippLotFilters.ippLotTypeCode == 'FORNITURE'}">
                                <span class="title">Forniture</span>
                            </a>
                            <a class="nav-link" matRipple (click)="setFilterIppLot('ippLotTypeCode', 'LAVORI')"
                                [ngClass]="{'accent': ippLotFilters.ippLotTypeCode == 'LAVORI'}">
                                <span class="title">Lavori</span>
                            </a>
                            <a class="nav-link" matRipple (click)="setFilterIppLot('ippLotTypeCode', 'SERVIZI')"
                                [ngClass]="{'accent': ippLotFilters.ippLotTypeCode == 'SERVIZI'}">
                                <span class="title">Servizi</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- / SIDEBAR CONTENT -->
    </fuse-sidebar>
    <!-- / SIDEBAR -->
    <!-- CENTER -->
    <div class="center">
        <!-- HEADER -->
        <div class="header p-24 primary" fxLayout="row" fxLayoutAlign="start center">
            <button mat-icon-button class="sidebar-toggle mr-8" fxHide.gt-md
                (click)="toggleSidebar('ipp-lot-filter-sidebar')">
                <mat-icon>menu</mat-icon>
            </button>
            <h2>Elenco Lotti</h2>
        </div>
        <!-- / HEADER -->
        <!-- CONTENT -->
        <div class="content mb-48">
            <agm-map [zoom]="5" [latitude]="lat" [longitude]="lng" (mapReady)="onMapReady($event)"></agm-map>
            <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let point of pointList">
                  {{ point.lat.toPrecision(5) }},
                  {{ point.lng.toPrecision(5) }}</mat-list-item
                >
              </mat-list>
              <mat-card *ngIf="selectedArea > 0">
                  <button (click)="deleteSelectedShape()">cancella</button>
                Selected Area: {{ selectedArea.toPrecision(5) }}m<sup>2</sup></mat-card
              >

            <ipp-lot-list-table [displayedColumns]="ippLotDisplayedColumns" [dataSource]="ippLotDTOs">
            </ipp-lot-list-table>

            <mat-paginator #ippLotPaginator [length]="ippLotLength" [pageIndex]="ippLotIndex"
                [pageSize]="ippLotPageable.size" [pageSizeOptions]="[30, 100, 200]"
                (page)="ippLotPaginatorEvent($event)"></mat-paginator>
        </div>
        <!-- / CONTENT -->
    </div>
    <!-- / CENTER -->
</div>